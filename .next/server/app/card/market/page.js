(()=>{var e={};e.id=661,e.ids=[661],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},99462:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>d.a,__next_app__:()=>u,originalPathname:()=>f,pages:()=>o,routeModule:()=>b,tree:()=>c}),t(59494),t(49789),t(35866);var s=t(23191),r=t(88716),n=t(37922),d=t.n(n),i=t(95231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(a,l);let c=["",{children:["card",{children:["market",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,59494)),"/home/runner/work/als_next.js/als_next.js/src/app/card/market/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,33159))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,49789)),"/home/runner/work/als_next.js/als_next.js/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,33159))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/home/runner/work/als_next.js/als_next.js/src/app/card/market/page.tsx"],f="/card/market/page",u={require:t,loadChunk:()=>Promise.resolve()},b=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/card/market/page",pathname:"/card/market",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},15879:(e,a,t)=>{let s={"0032af294b820d5b2f6ecb599810073224fb8405":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getCardTest),"2c8f731e7c04d6b71f833304321e741fa16aeefd":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.saveCard),"32a3617889b58b88de5846c96efc11d8a1322d4a":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.saveTag),"40b0e9a5fae5e29abe9213bb007d11cec6f7e31f":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getCard),"479742cc8645e1909d54f38cd9fe015e9621ab60":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.removeCard),"50b8ee2c01702d556b77028eb169eaff9ea0f820":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getCardsOfMy),"523b5dd287e6725b6f91274aca1051653bfdf0e6":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.removeTag),"59141756fe4b901c2b6407bb9725bab62d2967e1":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.createTag),"651d629a9efc5ac1f2e83ecc837477b8129dac19":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getTagAll),"6d2e69b109044da9a0608b4844be959036b9b175":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.setCardFamiliarity),"92a63b1efc916ff008d1272dc5a65580af78af67":()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getCardsOfOthers),ae2756021412af3c7533170046625d9bfe173ca7:()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.saveCardTag),b9098ba02eb30e332c60e216b96eda5868da288a:()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getTag),fbde93d90dfb682967795128b2ca856ab81d14aa:()=>Promise.resolve().then(t.bind(t,54463)).then(e=>e.getCardTag),"752d4765be8afd326d32b304cd957453103f93d0":()=>Promise.resolve().then(t.bind(t,1702)).then(e=>e.getUserByEmail),"7be741432e134b84b50ad1a2aed0d93168d824aa":()=>Promise.resolve().then(t.bind(t,1702)).then(e=>e.getUserByUsername),ce85166cf1a23c9f2a22a49b4f82895537edcfe6:()=>Promise.resolve().then(t.bind(t,1702)).then(e=>e.signOutUser),ee535fd2e1d6ef6ab42586363f44c0cbea1161f9:()=>Promise.resolve().then(t.bind(t,1702)).then(e=>e.registerUser),fe7b3552d9555bacd46a0fcf077d7272d19fd2c8:()=>Promise.resolve().then(t.bind(t,1702)).then(e=>e.signInUser)};async function r(e,...a){return(await s[e]()).apply(null,a)}e.exports={"0032af294b820d5b2f6ecb599810073224fb8405":r.bind(null,"0032af294b820d5b2f6ecb599810073224fb8405"),"2c8f731e7c04d6b71f833304321e741fa16aeefd":r.bind(null,"2c8f731e7c04d6b71f833304321e741fa16aeefd"),"32a3617889b58b88de5846c96efc11d8a1322d4a":r.bind(null,"32a3617889b58b88de5846c96efc11d8a1322d4a"),"40b0e9a5fae5e29abe9213bb007d11cec6f7e31f":r.bind(null,"40b0e9a5fae5e29abe9213bb007d11cec6f7e31f"),"479742cc8645e1909d54f38cd9fe015e9621ab60":r.bind(null,"479742cc8645e1909d54f38cd9fe015e9621ab60"),"50b8ee2c01702d556b77028eb169eaff9ea0f820":r.bind(null,"50b8ee2c01702d556b77028eb169eaff9ea0f820"),"523b5dd287e6725b6f91274aca1051653bfdf0e6":r.bind(null,"523b5dd287e6725b6f91274aca1051653bfdf0e6"),"59141756fe4b901c2b6407bb9725bab62d2967e1":r.bind(null,"59141756fe4b901c2b6407bb9725bab62d2967e1"),"651d629a9efc5ac1f2e83ecc837477b8129dac19":r.bind(null,"651d629a9efc5ac1f2e83ecc837477b8129dac19"),"6d2e69b109044da9a0608b4844be959036b9b175":r.bind(null,"6d2e69b109044da9a0608b4844be959036b9b175"),"92a63b1efc916ff008d1272dc5a65580af78af67":r.bind(null,"92a63b1efc916ff008d1272dc5a65580af78af67"),ae2756021412af3c7533170046625d9bfe173ca7:r.bind(null,"ae2756021412af3c7533170046625d9bfe173ca7"),b9098ba02eb30e332c60e216b96eda5868da288a:r.bind(null,"b9098ba02eb30e332c60e216b96eda5868da288a"),fbde93d90dfb682967795128b2ca856ab81d14aa:r.bind(null,"fbde93d90dfb682967795128b2ca856ab81d14aa"),"752d4765be8afd326d32b304cd957453103f93d0":r.bind(null,"752d4765be8afd326d32b304cd957453103f93d0"),"7be741432e134b84b50ad1a2aed0d93168d824aa":r.bind(null,"7be741432e134b84b50ad1a2aed0d93168d824aa"),ce85166cf1a23c9f2a22a49b4f82895537edcfe6:r.bind(null,"ce85166cf1a23c9f2a22a49b4f82895537edcfe6"),ee535fd2e1d6ef6ab42586363f44c0cbea1161f9:r.bind(null,"ee535fd2e1d6ef6ab42586363f44c0cbea1161f9"),fe7b3552d9555bacd46a0fcf077d7272d19fd2c8:r.bind(null,"fe7b3552d9555bacd46a0fcf077d7272d19fd2c8")}},43874:(e,a,t)=>{Promise.resolve().then(t.bind(t,52353))},52353:(e,a,t)=>{"use strict";t.d(a,{default:()=>l});var s=t(10326),r=t(17577),n=t(92715),d=t(42088),i=t(20111);function l({email:e,user_id:a}){let[t,l]=(0,r.useState)(!1),[c,o]=(0,r.useState)([]),[f,u]=(0,r.useState)(1),[b,x]=(0,r.useState)(0);return(0,s.jsxs)("div",{className:"flex flex-col w-full gap-2 py-2 px-2",children:[s.jsx("div",{children:"Cards"}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[s.jsx("div",{children:"Page"}),s.jsx(n.g,{showControls:!0,loop:!0,variant:"bordered",total:b,page:f,onChange:u})]}),t?s.jsx("div",{className:"flex flex-row w-full items-center justify-center gap-4",children:s.jsx(d.Z,{label:"Loading..."})}):s.jsx(i.Z,{email:e,card_list:c,edit_view:!1}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4",children:[s.jsx("div",{children:"Page"}),s.jsx(n.g,{showControls:!0,loop:!0,variant:"bordered",total:b,page:f,onChange:u})]})]})}t(53134)},20111:(e,a,t)=>{"use strict";t.d(a,{Z:()=>S});var s=t(10326),r=t(17577),n=t(66836),d=t(76917),i=t(14509),l=t(56655),c=t(41368),o=t(24558),f=t(99884),u=t(70175),b=t(88336),x=t(38647),m=t(23869),h=t(53134),p=t(42088),g=t(38307),v=t(90831),j=t(74723),y=t(65825);function _({email:e,card:a,tag_list:t}){let[d,i]=(0,r.useState)(!1),[l,c]=(0,r.useState)(t||[]),[o,f]=(0,r.useState)([]),[u,b]=(0,r.useState)([]),{handleSubmit:x}=(0,j.cI)(),m=async()=>{let e={uuid:a.uuid,tag_list_new:u.filter(e=>!o.includes(e)),tag_list_remove:o.filter(e=>!u.includes(e))};"success"===(await (0,h.pl)(e)).status?y.Am.success("save tag successfully"):y.Am.error("save tag failed")};return s.jsx(s.Fragment,{children:d?s.jsx(p.Z,{}):s.jsx("form",{onSubmit:x(m),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex flex-row items-center justify-start gap-1",children:l.length>0?s.jsx(g.X,{color:"success",value:u,onValueChange:b,orientation:"vertical",children:l.map(e=>s.jsx(v.K,{value:e.uuid,children:e.tag},e.uuid))}):s.jsx("div",{children:"not tag found"})}),s.jsx("div",{className:"flex flex-row items-center justify-end gap-1",children:s.jsx(n.O,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var w=t(50813),P=t(51223);function N({email:e,card:a}){let[t,d]=(0,r.useState)([]),[i,l]=(0,r.useState)([]),{handleSubmit:c}=(0,j.cI)(),o=async()=>{let t={...a,uuid:(0,P.Fs)(),user_id:e,familiarity:0,note:(a.note?a.note+"\n":"")+`{"collect_from":${JSON.stringify(a.user_id)}, "source_uuid":${JSON.stringify(a.uuid)}}`,updated_at:new Date};if("success"===(await (0,h.z_)(t)).status)y.Am.success("save card successfully");else{y.Am.error("save card failed");return}"success"===(await (0,h.pl)({uuid:a.uuid,tag_list_new:i})).status?y.Am.success("save tag successfully"):y.Am.error("save tag failed")};return s.jsx("form",{onSubmit:c(o),children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"flex flex-row items-center justify-start gap-1",children:t.length>0?s.jsx(g.X,{color:"success",value:i,onValueChange:l,children:t.map(e=>s.jsx(v.K,{value:e.uuid,children:e.tag},e.uuid))}):s.jsx("div",{className:"px-1 pt-1",children:"not tag found"})}),s.jsx("div",{className:"flex flex-row items-center justify-end gap-1",children:s.jsx(n.O,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function k({email:e,card:a,edit_view:t,tag_list:p}){let[g,v]=(0,r.useState)(a.familiarity),[j,P]=(0,r.useState)(p||[]),k=a.user_id===e,S=e=>k?w.zQ.map(e=>e.color)[e]:w.zQ.map(e=>e.color)[0];return(0,s.jsxs)("div",{className:`flex flex-col w-full items-start rounded-md p-1 ${S(g)}`,children:[s.jsx("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:s.jsx(n.O,{target:"_blank",href:`/card/${a.uuid}${t?"?edit=y":""}`,className:"text-2xl text-blue-600 hover:underline",children:s.jsx("pre",{className:"font-roboto leading-none text-wrap",children:a.question})})}),!k&&s.jsx(n.O,{target:"_blank",href:`/card/market?user_id=${a.user_id}`,className:"text-sm text-gray-500 hover:underline",children:`by ${a.user_id}`}),(0,s.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[k&&s.jsx(d.e,{content:`current: ${g}
${w.zQ.map(e=>e.description)[g]}`,children:s.jsx(i.g,{variant:"solid",color:"primary",children:(0,s.jsxs)(f.F,{placement:"bottom-end",children:[s.jsx(u.S,{children:s.jsx(n.O,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),s.jsx(b.a,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[g],onSelectionChange:async t=>{if(t.currentKey){let s=parseInt(t.currentKey);v(s),"success"===(await (0,h.lq)(e,a.uuid,s)).status?y.Am.success("save familiarity successfully"):y.Am.error("save familiarity failed")}},children:s.jsx(x.d,{items:w.zQ,children:w.zQ.map(e=>s.jsx(m.W,{description:e.description,className:`${S(e.value)}`,children:`${e.value} - ${e.label}`},e.value))})})]})})}),k&&(0,s.jsxs)(l.j,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[s.jsx(c.b,{children:s.jsx(n.O,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),s.jsx(o.g,{children:s.jsx(_,{email:e,card:a,tag_list:j})})]}),!k&&(0,s.jsxs)(l.j,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[s.jsx(c.b,{children:s.jsx(n.O,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),s.jsx(o.g,{children:s.jsx(N,{email:e,card:a})})]})]})]})}function S({email:e,edit_view:a,card_list:t}){return s.jsx("div",{className:"flex flex-col w-full gap-2",children:t.map(t=>s.jsx(k,{email:e,card:t,edit_view:a},t.uuid))})}},59494:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var s=t(19510),r=t(35089);t(71159);var n=t(68570);let d=(0,n.createProxy)(String.raw`/home/runner/work/als_next.js/als_next.js/src/app/card/market/CardMarket.tsx`),{__esModule:i,$$typeof:l}=d;d.default;let c=(0,n.createProxy)(String.raw`/home/runner/work/als_next.js/als_next.js/src/app/card/market/CardMarket.tsx#default`);async function o({params:e,searchParams:a}){let t=await (0,r.I8)(),n=t?.user?.email||"",d="string"==typeof a.user_id?a.user_id:"";return s.jsx(c,{email:n,user_id:d})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[8948,2950,9588,6621,934,3945,6836,6619,6917,2088,7440,4723,6636,847,1867],()=>t(99462));module.exports=s})();