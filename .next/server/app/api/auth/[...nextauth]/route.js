"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},72254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},47261:e=>{e.exports=require("node:util")},54258:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>m,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{GET:()=>o,POST:()=>u});var a=t(49303),n=t(88716),i=t(60670);let{GET:o,POST:u}=t(83862).handlers,c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/home/runner/work/als_next.js/als_next.js/src/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:p}=c,f="/api/auth/[...nextauth]/route";function m(){return(0,i.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:l})}},49303:(e,r,t)=>{e.exports=t(30517)},29484:(e,r,t)=>{t.r(r),t.d(r,{getUserByEmail:()=>l,getUserByUsername:()=>d,registerUser:()=>p,signInUser:()=>f,signOutUser:()=>m});var s=t(24330);t(60166);var a=t(83862),n=t(13538),i=t(7410);let o=i.z.object({username:i.z.string(),email:i.z.string().email(),password:i.z.string().min(6,{message:"Password must be at least 6 characters"})});var u=t(7017),c=t(62950);async function d(e){try{let r=await n._.auth_user.findFirst({where:{username:e}});if(!r)return{status:"error",error:"user not found"};return{status:"success",data:r}}catch(e){return console.log(e),{status:"error",error:e.toString()}}}async function l(e){try{let r=await n._.auth_user.findUnique({where:{email:e}});if(!r)return{status:"error",error:"user not found"};return{status:"success",data:r}}catch(e){return console.log(e),{status:"error",error:e.toString()}}}async function p(e){try{let r=o.safeParse(e);if(!r.success)return{status:"error",error:r.error.errors};let{username:t,email:s,password:a}=r.data,i=await d(t);if("success"===i.status)return{status:"error",error:"username has been used"};let c=await l(s);if("success"===c.status)return{status:"error",error:"email has been used"};let p=(0,u.St)(a,10),f=await n._.auth_user.create({data:{password:p,is_superuser:!1,username:t,first_name:"",last_name:"",email:s,is_staff:!1,is_active:!0,date_joined:new Date}});return{status:"success",data:{name:f.username,email:f.email}}}catch(e){return console.log(e),{status:"error",error:"internal error"}}}async function f(e){try{let r=await (0,a.zB)("credentials",{email:e.email,password:e.password,redirect:!1});return console.log(r),{status:"success",data:"signin successfully"}}catch(e){if(console.log(e),e instanceof c.l4){if("CredentialsSignin"===e.type)return{status:"error",error:"invalid credentials"};return{status:"error",error:"signin failed 1"}}return{status:"error",error:"signin failed 2"}}}async function m(){await (0,a.w7)({redirectTo:"/"})}(0,t(40618).h)([d,l,p,f,m]),(0,s.j)("7be741432e134b84b50ad1a2aed0d93168d824aa",d),(0,s.j)("752d4765be8afd326d32b304cd957453103f93d0",l),(0,s.j)("ee535fd2e1d6ef6ab42586363f44c0cbea1161f9",p),(0,s.j)("fe7b3552d9555bacd46a0fcf077d7272d19fd2c8",f),(0,s.j)("ce85166cf1a23c9f2a22a49b4f82895537edcfe6",m)},83862:(e,r,t)=>{t.d(r,{I8:()=>m,handlers:()=>l,zB:()=>p,w7:()=>f});var s=t(62950),a=t(7585),n=t(27600),i=t(7017),o=t(13538),u=t(7410);let c=u.z.object({email:u.z.string().email(),password:u.z.string().min(6,{message:"Password must be at least 6 characters"})});var d=t(29484);let{handlers:l,signIn:p,signOut:f,auth:m}=(0,s.ZP)({adapter:(0,a.N)(o._),session:{strategy:"jwt"},providers:[(0,n.Z)({credentials:{email:{},password:{}},authorize:async e=>{let r=c.safeParse(e);if(r.success){let{email:e,password:t}=r.data,s=await (0,d.getUserByEmail)(e);if("success"===s.status){let e=s.data;if((0,i.oH)(t,e.password))return{name:e.username,email:e.email}}}return null}})]})},13538:(e,r,t)=>{t.d(r,{_:()=>a});var s=t(53524);let a=global.prisma||new s.PrismaClient({log:["query"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,136],()=>t(54258));module.exports=s})();