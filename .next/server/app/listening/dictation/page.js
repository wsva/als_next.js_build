(()=>{var e={};e.id=9276,e.ids=[9276],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},47261:e=>{"use strict";e.exports=require("node:util")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},9668:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(91544),s(49789),s(35866);var n=s(23191),r=s(88716),i=s(37922),a=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["listening",{children:["dictation",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,91544)),"/home/runner/work/als_next.js/als_next.js/src/app/listening/dictation/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,33159))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,49789)),"/home/runner/work/als_next.js/als_next.js/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,33159))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/home/runner/work/als_next.js/als_next.js/src/app/listening/dictation/page.tsx"],u="/listening/dictation/page",p={require:s,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/listening/dictation/page",pathname:"/listening/dictation",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},33931:(e,t,s)=>{Promise.resolve().then(s.bind(s,18253))},18253:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>C});var n=s(10326),r=s(17577),i=s(41316),a=s(1311),l=s(14509),o=s(99884),c=s(70175),d=s(88336),u=s(23869),p=s(36780),h=s(69562),x=s(76917),m=s(16510),f=s(74034);function j(e){return(0,f.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},child:[]}]})(e)}function g(e){return(0,f.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"},child:[]}]})(e)}function v(e){return(0,f.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"},child:[]}]})(e)}function b(e){return(0,f.w_)({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM9.5 16.5v-9l7 4.5-7 4.5z"},child:[]}]})(e)}var y=s(90434);function w({item:e,index:t,media:s,with_translation:l}){let[o,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),w=t=>t===e.content()||h.H.pureContent(t)===h.H.pureContent(e.content());return(0,n.jsxs)("div",{className:"flex flex-row items-center justify-start w-full gap-1",children:[n.jsx(x.e,{content:"turn green on success: punctuation does not matter",children:n.jsx(m.h,{size:"sm",radius:"sm",name:`${e.position}`,color:d?"success":"default"})}),n.jsx(x.e,{content:"shortcut: Ctrl+S, Ctrl+D, or type two spaces at the end",children:n.jsx(a.A,{isIconOnly:!0,variant:"light",tabIndex:-1,onPress:()=>{s.paused?e.playMedia(s,!1):s.pause()},children:n.jsx(b,{size:30})})}),n.jsx(x.e,{isOpen:p,placement:"top",className:"bg-slate-300",content:n.jsx("div",{className:"flex flex-col items-start justify-start text-xl px-4 py-2",children:n.jsx("div",{children:(t=>{let s=h.H.splitContent(t,!0).map(e=>e.content),n=h.H.splitContent(e.content(),!1);for(let e=0;e<n.length;e++)n[e].isWord&&!s.includes(n[e].content)&&(n[e].content=h.H.hideWord(n[e].content));return n.map(e=>e.content).join("")})(o)})}),children:n.jsx(i.Y,{"aria-label":"input answer",variant:"bordered",id:`d-s-i-${t}`,classNames:{input:"text-xl font-bold"},value:o,onChange:t=>{let n=t.target.value;n.endsWith("  ")?s.paused?e.playMedia(s,!1):s.pause():(c(n),!d&&w(n)&&u(!0),d&&!w(n)&&u(!1))},onFocus:e=>{f(!0)},onBlur:e=>{f(!1)},onKeyDown:t=>{t.ctrlKey&&"sS".includes(t.key)&&(s.paused?e.playMedia(s,!1):s.pause(),t.preventDefault()),t.ctrlKey&&"dD".includes(t.key)&&(s.paused?e.playMedia(s,!0):s.pause(),t.preventDefault())}})}),l?n.jsx(x.e,{placement:"top-end",className:"bg-slate-300",content:n.jsx("div",{className:"flex flex-col items-start justify-start text-xl px-4 py-2",children:n.jsx("pre",{children:e.translation_list.length>0?e.translation().replaceAll(/\d/g,"x"):"no translation"})}),children:n.jsx(a.A,{isIconOnly:!0,variant:"light",tabIndex:-1,children:n.jsx(g,{size:30})})}):null,n.jsx(x.e,{placement:"top-end",className:"bg-slate-300",content:n.jsx("div",{className:"text-xl px-4 py-2",children:e.content()}),children:n.jsx(a.A,{isIconOnly:!0,variant:"light",tabIndex:-1,children:n.jsx(v,{size:30})})}),n.jsx(x.e,{color:"primary",content:"add card",children:n.jsx(a.A,{isIconOnly:!0,variant:"light",tabIndex:-1,as:y.default,target:"_blank",href:`/card/add?edit=y&question=${encodeURIComponent(e.content())}`,children:n.jsx(j,{size:20})})})]})}var _=s(61980);let N=({href:e,children:t})=>n.jsx(y.default,{href:e,className:"text-blue-600 underline",target:"_blank",children:t});function C(){let[e,t]=(0,r.useState)(),[s,x]=(0,r.useState)(),[m,f]=(0,r.useState)(!1),[j,g]=(0,r.useState)(!1),[v,b]=(0,r.useState)(""),[y,C]=(0,r.useState)(""),[P,M]=(0,r.useState)([]),S=(0,r.useRef)(null),k=(0,r.useRef)(null),z=(0,r.useRef)(null),R=(0,r.useRef)(null),q=e=>{C(e);let t=h.H.parse_srt_content(e,m);"success"===t.status?t.data.length>0&&(M(t.data),b("")):b(t.error)},H=e=>()=>{let t=1e3*e.currentTime;for(let e=0;e<P.length;e++)if(t<=P[e].end_ms){let t=document.getElementById(`d-s-i-${e}`);t?.scrollIntoView({behavior:"smooth",block:"center"}),t?.focus();break}},W=e=>{e.addEventListener("timeupdate",H(e)),e.addEventListener("seeking",H(e))};return z.current&&W(z.current),R.current&&W(R.current),(0,n.jsxs)("div",{children:[e&&n.jsx("div",{className:"sticky top-0 p-4 z-50",children:n.jsx("audio",{className:"w-full",ref:z,controls:!0,src:e})}),s&&n.jsx("div",{className:"flex flex-row items-end justify-end fixed bottom-0 end-0 p-4 z-50",children:n.jsx("video",{className:"h-[30vh] w-auto max-w-full",ref:R,controls:!0,src:s})}),(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center gap-4 my-2",children:[n.jsx(i.Y,{className:"hidden",type:"file",ref:S,onChange:e=>{let s=e.target.files[0];if(s.type.startsWith("audio/")){t(URL.createObjectURL(s));return}if(s.type.startsWith("video/")){x(URL.createObjectURL(s));return}}}),!e&&!s&&n.jsx(a.A,{variant:"solid",color:"primary",onPress:()=>S.current?.click(),children:"select audio/video"}),n.jsx(i.Y,{className:"hidden",type:"file",ref:k,onChange:async e=>{let t=e.target.files[0],s=(await t.text()).trim().replaceAll("\r\n","\n").replaceAll("\r","\n"),n=[];for(let e of s.split("\n"))if(!(n.length<1)||"1"===e){if(n.length>0&&e.endsWith("`;"))break;n.push(e)}q(n.join("\n"))}}),(!!e||!!s)&&(0,n.jsxs)(n.Fragment,{children:[n.jsx(l.g,{variant:"solid",color:"primary",isDisabled:!e&&!s,children:(0,n.jsxs)(o.F,{placement:"bottom-end",children:[n.jsx(c.S,{children:(0,n.jsxs)(a.A,{children:["select subtitle ",n.jsx(_.QBW,{})]})}),(0,n.jsxs)(d.a,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",onSelectionChange:e=>{"no_translation"===e.currentKey?f(!1):f(!0),k.current?.click()},children:[n.jsx(u.W,{description:"This subtitle file does not contain translations.",children:"No Translation"},"no_translation"),n.jsx(u.W,{description:"This subtitle file contains translations.",children:"With Translation"},"with_translation")]})]})}),n.jsx(a.A,{variant:"solid",color:"primary",isDisabled:!e&&!s,onPress:()=>g(!j),children:"edit subtitle"})]})]}),v.length>0&&n.jsx("pre",{className:"my-4",children:v}),j&&n.jsx(p.Y,{variant:"bordered",value:y,className:"my-4",onChange:e=>q(e.target.value)}),!e&&!s&&(0,n.jsxs)("div",{className:"text-xl",children:[n.jsx("p",{children:"1, Practice dictation using videos (or audios) and their corresponding subtitles"}),n.jsx("p",{children:"2, Subtitle files should be in srt format"}),n.jsx("p",{children:"3, Example: TED"}),(0,n.jsxs)("div",{className:"ms-8 bg-slate-100",children:[(0,n.jsxs)("p",{children:["1, Download video from ",n.jsx(N,{href:"https://www.ted.com",children:"www.ted.com"}),': click "Share" to download MP4']}),n.jsx("p",{children:"2, Subtitles are already included in the video. You can extract them using an ffmpeg command:"}),n.jsx("p",{className:"ps-8",children:'ffprobe exampe.mp4 2>&1 | grep "Subtitle:"'}),n.jsx("p",{className:"ps-8",children:"find english subtitle, for example: #0:6[0x7](eng), to extract it:"}),n.jsx("p",{className:"ps-8",children:"ffmpeg -i exampe.mp4 -map 0:6 exampe.srt"})]}),n.jsx("p",{children:"4, Example: ARD Mediathek"}),(0,n.jsxs)("div",{className:"ms-8 bg-slate-100",children:[(0,n.jsxs)("p",{children:["1, Download video and subtitle using ",n.jsx(N,{href:"https://mediathekview.de/download/",children:"MediathekView"})]}),(0,n.jsxs)("p",{children:["2, Process and prepare subtitles ",n.jsx(N,{href:"/listening/subtitle/prepare",children:"here"})]})]}),n.jsx("p",{children:"5, Example: logo"}),(0,n.jsxs)("div",{className:"ms-8 bg-slate-100",children:[n.jsx("p",{children:"1, Download video/audio and html file from logo会员群"}),n.jsx("p",{children:"2, Use html file directly as subtitle file"})]})]}),(!!e||!!s)&&0===P.length&&(0,n.jsxs)("div",{className:"text-xl",children:[n.jsx("p",{children:"1, 如果是 logo 的用于听写的 html 文件，直接上传即可（选 With Translation）"}),n.jsx("p",{children:"2, 如果是其他字幕，文件应当是 srt 格式"}),n.jsx("p",{children:"3, 根据字幕中是否含有译文，点击不同的选项，同时应符合以下要求"}),n.jsx("p",{className:"ps-8",children:"a, 如果不包含译文，则每条字幕中原文可以有多行"}),n.jsx("p",{className:"ps-8",children:"b, 如果包含译文，则每条字幕中原文只能占一行，但译文可以有多行"}),n.jsx("p",{className:"ps-8",children:"c, 如果包含译文，原文在上，译文在下，且只能有一种译文"}),n.jsx("p",{className:"ps-8",children:"d, 原文和译文都要去掉格式信息，只保留文本"}),n.jsx("p",{children:"4, 如下字幕格式，包含原文和译文："}),n.jsx("pre",{className:"ps-8 bg-slate-100",children:"45\n00:02:32,560 --> 00:02:34,240\nWie bitte?\n你说什么？"}),n.jsx("p",{children:"5, 如下字幕格式，因为原文占用了 2 行，因此不再支持译文："}),n.jsx("pre",{className:"ps-8 bg-slate-100",children:"45\n00:02:32,560 --> 00:02:34,240\nWie \nbitte?"}),(0,n.jsxs)("p",{children:["6, 如下字幕格式是",n.jsx("b",{children:"不正确"}),"的，因为原文除了文本，还有字体、颜色等格式信息："]}),n.jsx("pre",{className:"ps-8 bg-slate-100",children:'45\n00:02:32,560 --> 00:02:34,240\n<font color="#ffffff">Wie bitte?</font>'})]}),n.jsx("div",{className:"flex flex-col items-center justify-start w-full gap-2 my-8",children:P.map((t,s)=>n.jsx(w,{item:t,index:s,with_translation:m,media:e?z.current:R.current},s))})]})}},91544:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>i,default:()=>l});var n=s(68570);let r=(0,n.createProxy)(String.raw`/home/runner/work/als_next.js/als_next.js/src/app/listening/dictation/page.tsx`),{__esModule:i,$$typeof:a}=r;r.default;let l=(0,n.createProxy)(String.raw`/home/runner/work/als_next.js/als_next.js/src/app/listening/dictation/page.tsx#default`)},14509:(e,t,s)=>{"use strict";s.d(t,{g:()=>o});var n=s(82416),r=s(33657),i=s(98349),a=s(10326),l=(0,i.Gp)((e,t)=>{let{Component:s,domRef:i,context:l,children:o,classNames:c,getButtonGroupProps:d}=(0,n.i)({...e,ref:t});return(0,a.jsx)(r.D,{value:l,children:(0,a.jsx)(s,{ref:i,className:c,...d(),children:o})})});l.displayName="HeroUI.ButtonGroup";var o=l},82416:(e,t,s)=>{"use strict";s.d(t,{i:()=>c});var n=s(4601),r=s(19747),i=s(98349),a=s(58435),l=s(17577),o=s(92256);function c(e){var t,s;let c=(0,r.w)(),[d,u]=(0,i.oe)(e,n.D.variantKeys),{ref:p,as:h,children:x,color:m="default",size:f="md",variant:j="solid",radius:g,isDisabled:v=!1,isIconOnly:b=!1,disableRipple:y=null!=(t=null==c?void 0:c.disableRipple)&&t,disableAnimation:w=null!=(s=null==c?void 0:c.disableAnimation)&&s,className:_,...N}=d,C=(0,a.gy)(p),P=(0,l.useMemo)(()=>(0,n.D)({...u,className:_}),[(0,o.Xx)(u),_]);return{Component:h||"div",children:x,domRef:C,context:(0,l.useMemo)(()=>({size:f,color:m,variant:j,radius:g,isIconOnly:b,isDisabled:v,disableAnimation:w,disableRipple:y,fullWidth:!!(null==e?void 0:e.fullWidth)}),[f,m,j,g,v,b,w,y,null==e?void 0:e.fullWidth]),classNames:P,getButtonGroupProps:(0,l.useCallback)(()=>({role:"group",...N}),[N])}}},36780:(e,t,s)=>{"use strict";s.d(t,{Y:()=>j});var n=s(64382),r=s(28142),i=s(98349),a=s(18982),l=s(17577);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(null,arguments)}var c=function(e,t){if("function"==typeof e){e(t);return}e.current=t};let d=function(e,t){var s=(0,l.useRef)();return(0,l.useCallback)(function(n){e.current=n,s.current&&c(s.current,null),s.current=t,t&&c(t,n)},[t])};var u=function(){},p=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],h=l.forwardRef(function(e,t){e.cacheMeasurements,e.maxRows,e.minRows;var s=e.onChange;e.onHeightChange;var n=function(e,t){if(null==e)return{};var s={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(t.includes(n))continue;s[n]=e[n]}return s}(e,p);n.value;var r=d(l.useRef(null),t);return l.useRef(0),l.useRef(),l.createElement("textarea",o({},n,{onChange:void 0===s?u:s,ref:r}))}),x=s(88621),m=s(10326),f=(0,i.Gp)(({style:e,minRows:t=3,maxRows:s=8,cacheMeasurements:i=!1,disableAutosize:o=!1,onHeightChange:c,...d},u)=>{let{Component:p,label:f,description:j,startContent:g,endContent:v,hasHelper:b,shouldLabelBeOutside:y,shouldLabelBeInside:w,isInvalid:_,errorMessage:N,getBaseProps:C,getLabelProps:P,getInputProps:M,getInnerWrapperProps:S,getInputWrapperProps:k,getHelperWrapperProps:z,getDescriptionProps:R,getErrorMessageProps:q,isClearable:H,getClearButtonProps:W}=(0,n.G)({...d,ref:u,isMultiline:!0}),[A,D]=(0,l.useState)(t>1),[E,I]=(0,l.useState)(!1),O=f?(0,m.jsx)("label",{...P(),children:f}):null,B=M(),G=o?(0,m.jsx)("textarea",{...B,style:(0,a.d)(B.style,null!=e?e:{})}):(0,m.jsx)(h,{...B,cacheMeasurements:i,"data-hide-scroll":(0,r.PB)(!E),maxRows:s,minRows:t,style:(0,a.d)(B.style,null!=e?e:{}),onHeightChange:(e,n)=>{1===t&&D(e>=2*n.rowHeight),s>t&&I(e>=s*n.rowHeight),null==c||c(e,n)}}),T=(0,l.useMemo)(()=>H?(0,m.jsx)("button",{...W(),children:(0,m.jsx)(x.f,{})}):null,[H,W]),U=(0,l.useMemo)(()=>g||v?(0,m.jsxs)("div",{...S(),children:[g,G,v]}):(0,m.jsx)("div",{...S(),children:G}),[g,B,v,S]),L=_&&N,Y=L||j;return(0,m.jsxs)(p,{...C(),children:[y?O:null,(0,m.jsxs)("div",{...k(),"data-has-multiple-rows":(0,r.PB)(A),children:[w?O:null,U,T]}),b&&Y?(0,m.jsx)("div",{...z(),children:L?(0,m.jsx)("div",{...q(),children:N}):(0,m.jsx)("div",{...R(),children:j})}):null]})});f.displayName="HeroUI.Textarea";var j=f}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),n=t.X(0,[8948,2950,4963,6621,934,3656,1980,6510,8051],()=>s(9668));module.exports=n})();