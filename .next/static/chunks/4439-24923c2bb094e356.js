(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4439],{42480:function(){},55195:function(e,t,a){"use strict";a.d(t,{Aj:function(){return g},CZ:function(){return u},LG:function(){return o},fM:function(){return c},ln:function(){return f},lq:function(){return d},mg:function(){return i},pl:function(){return s},tc:function(){return m},yJ:function(){return r},z_:function(){return l}}),a(74590);var n=a(58064),s=(0,n.$)("ae2756021412af3c7533170046625d9bfe173ca7"),c=(0,n.$)("50b8ee2c01702d556b77028eb169eaff9ea0f820"),i=(0,n.$)("92a63b1efc916ff008d1272dc5a65580af78af67");(0,n.$)("40b0e9a5fae5e29abe9213bb007d11cec6f7e31f");var l=(0,n.$)("2c8f731e7c04d6b71f833304321e741fa16aeefd");(0,n.$)("0032af294b820d5b2f6ecb599810073224fb8405");var r=(0,n.$)("479742cc8645e1909d54f38cd9fe015e9621ab60"),d=(0,n.$)("6d2e69b109044da9a0608b4844be959036b9b175");(0,n.$)("b9098ba02eb30e332c60e216b96eda5868da288a");var u=(0,n.$)("651d629a9efc5ac1f2e83ecc837477b8129dac19"),o=(0,n.$)("32a3617889b58b88de5846c96efc11d8a1322d4a"),f=(0,n.$)("59141756fe4b901c2b6407bb9725bab62d2967e1"),m=(0,n.$)("523b5dd287e6725b6f91274aca1051653bfdf0e6"),g=(0,n.$)("fbde93d90dfb682967795128b2ca856ab81d14aa")},6611:function(e,t,a){"use strict";a.d(t,{Z:function(){return U}});var n=a(57437),s=a(2265),c=a(79413),i=a(34471),l=a(76993),r=a(73389),d=a(87949),u=a(30502),o=a(70971),f=a(11956),m=a(52150),g=a(12959),x=a(7017),b=a(55195),p=a(94862),v=a(8052),h=a(53440),j=a(39343),y=a(93999);function N(e){let{email:t,card:a,tag_list:i}=e,[l,r]=(0,s.useState)(!1),[d,u]=(0,s.useState)(i||[]),[o,f]=(0,s.useState)([]),[m,g]=(0,s.useState)([]),{handleSubmit:x}=(0,j.cI)();(0,s.useEffect)(()=>{(async()=>{r(!0);let e=d;if(0==d.length){let a=await (0,b.CZ)(t);if("success"!==a.status)return;e=a.data,u(a.data)}let n=await (0,b.Aj)(t,a.uuid);"success"===n.status&&n.data.tag_list_added&&(f(n.data.tag_list_added),g(n.data.tag_list_added.filter(t=>e.map(e=>e.uuid).includes(t)))),r(!1)})()},[]);let N=async()=>{let e={uuid:a.uuid,tag_list_new:m.filter(e=>!o.includes(e)),tag_list_remove:o.filter(e=>!m.includes(e))};"success"===(await (0,b.pl)(e)).status?y.Am.success("save tag successfully"):y.Am.error("save tag failed")};return(0,n.jsx)(n.Fragment,{children:l?(0,n.jsx)(p.Z,{}):(0,n.jsx)("form",{onSubmit:x(N),children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:d.length>0?(0,n.jsx)(v.X,{color:"success",value:m,onValueChange:g,orientation:"vertical",children:d.map(e=>(0,n.jsx)(h.K,{value:e.uuid,children:e.tag},e.uuid))}):(0,n.jsx)("div",{children:"not tag found"})}),(0,n.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,n.jsx)(c.O,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})})}var w=a(44379),_=a(49354);function S(e){let{email:t,card:a}=e,[i,l]=(0,s.useState)([]),[r,d]=(0,s.useState)([]),{handleSubmit:u}=(0,j.cI)();(0,s.useEffect)(()=>{(async()=>{let e=await (0,b.CZ)(t);"success"===e.status&&l(e.data)})()},[]);let o=async()=>{let e={...a,uuid:(0,_.Fs)(),user_id:t,familiarity:0,note:(a.note?a.note+"\n":"")+'{"collect_from":'.concat(JSON.stringify(a.user_id),', "source_uuid":').concat(JSON.stringify(a.uuid),"}"),updated_at:new Date};if("success"===(await (0,b.z_)(e)).status)y.Am.success("save card successfully");else{y.Am.error("save card failed");return}"success"===(await (0,b.pl)({uuid:a.uuid,tag_list_new:r})).status?y.Am.success("save tag successfully"):y.Am.error("save tag failed")};return(0,n.jsx)("form",{onSubmit:u(o),children:(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"flex flex-row items-center justify-start gap-1",children:i.length>0?(0,n.jsx)(v.X,{color:"success",value:r,onValueChange:d,children:i.map(e=>(0,n.jsx)(h.K,{value:e.uuid,children:e.tag},e.uuid))}):(0,n.jsx)("div",{className:"px-1 pt-1",children:"not tag found"})}),(0,n.jsx)("div",{className:"flex flex-row items-center justify-end gap-1",children:(0,n.jsx)(c.O,{as:"button",type:"submit",className:"bg-blue-500 rounded-md text-slate-50 px-2",children:"save"})})]})})}function A(e){let{email:t,card:a,edit_view:p,tag_list:v}=e,[h,j]=(0,s.useState)(a.familiarity),[_,A]=(0,s.useState)(v||[]),U=a.user_id===t,$=e=>U?w.zQ.map(e=>e.color)[e]:w.zQ.map(e=>e.color)[0];return(0,n.jsxs)("div",{className:"flex flex-col w-full items-start rounded-md p-1 ".concat($(h)),children:[(0,n.jsx)("div",{className:"flex flex-row w-full items-center justify-start gap-2",children:(0,n.jsx)(c.O,{target:"_blank",href:"/card/".concat(a.uuid).concat(p?"?edit=y":""),className:"text-2xl text-blue-600 hover:underline",children:(0,n.jsx)("pre",{className:"font-roboto leading-none text-wrap",children:a.question})})}),!U&&(0,n.jsx)(c.O,{target:"_blank",href:"/card/market?user_id=".concat(a.user_id),className:"text-sm text-gray-500 hover:underline",children:"by ".concat(a.user_id)}),(0,n.jsxs)("div",{className:"flex flex-row w-full items-end justify-end gap-4",children:[U&&(0,n.jsx)(i.e,{content:"current: ".concat(h,"\n").concat(w.zQ.map(e=>e.description)[h]),children:(0,n.jsx)(l.g,{variant:"solid",color:"primary",children:(0,n.jsxs)(o.F,{placement:"bottom-end",children:[(0,n.jsx)(f.S,{children:(0,n.jsx)(c.O,{as:"button",isBlock:!0,className:"text-xl",children:"set familiarity"})}),(0,n.jsx)(m.a,{disallowEmptySelection:!0,className:"max-w-[300px]",selectionMode:"single",defaultSelectedKeys:[h],onSelectionChange:async e=>{if(e.currentKey){let n=parseInt(e.currentKey);j(n),"success"===(await (0,b.lq)(t,a.uuid,n)).status?y.Am.success("save familiarity successfully"):y.Am.error("save familiarity failed")}},children:(0,n.jsx)(g.d,{items:w.zQ,children:w.zQ.map(e=>(0,n.jsx)(x.W,{description:e.description,className:"".concat($(e.value)),children:"".concat(e.value," - ").concat(e.label)},e.value))})})]})})}),U&&(0,n.jsxs)(r.j,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,n.jsx)(d.b,{children:(0,n.jsx)(c.O,{as:"button",isBlock:!0,className:"text-xl",children:"edit tag"})}),(0,n.jsx)(u.g,{children:(0,n.jsx)(N,{email:t,card:a,tag_list:_})})]}),!U&&(0,n.jsxs)(r.j,{placement:"top-end",classNames:{content:"bg-slate-200"},children:[(0,n.jsx)(d.b,{children:(0,n.jsx)(c.O,{as:"button",isBlock:!0,className:"text-xl",children:"collect"})}),(0,n.jsx)(u.g,{children:(0,n.jsx)(S,{email:t,card:a})})]})]})]})}function U(e){let{email:t,edit_view:a,card_list:s}=e;return(0,n.jsx)("div",{className:"flex flex-col w-full gap-2",children:s.map(e=>(0,n.jsx)(A,{email:t,card:e,edit_view:a},e.uuid))})}},44379:function(e,t,a){"use strict";var n,s,c,i;a.d(t,{_Y:function(){return l},j8:function(){return r},ll:function(){return d},nr:function(){return u},vA:function(){return n},zQ:function(){return o}}),(c=n||(n={})).Normal="normal",c.Easy="easy",c.Unspecified="unspecified",c.Uncomplete="uncomplete";let l=[{value:"unspecified",description:"all"},{value:"normal",description:"familiarity < 6"},{value:"easy",description:"familiarity = 6"},{value:"uncomplete",description:"question or answer is empty"}],r="unspecified",d="all tagged",u="not tagged";(i=s||(s={}))[i.NewlyAdded=0]="NewlyAdded",i[i.StillUnfamiliar=1]="StillUnfamiliar",i[i.PassiveUnderstanding=2]="PassiveUnderstanding",i[i.RecognitionWithoutUnderstanding=3]="RecognitionWithoutUnderstanding",i[i.UnderstandingInContext=4]="UnderstandingInContext",i[i.ActiveRecall=5]="ActiveRecall",i[i.NaturalUsage=6]="NaturalUsage";let o=[{value:0,description:"Newly Added",label:"newly added",color:"bg-slate-200"},{value:1,description:"Still Unfamiliar",label:"strange",color:"bg-red-200"},{value:2,description:"Passive Understanding",label:"known",color:"bg-orange-200"},{value:3,description:"Recognition Without Understanding",label:"familiar",color:"bg-amber-200"},{value:4,description:"Understanding in Context",label:"skilled",color:"bg-cyan-200"},{value:5,description:"Active Recall",label:"practiced",color:"bg-green-200"},{value:6,description:"Natural Usage",label:"easy & never appear again",color:"bg-lime-200"}]},49354:function(e,t,a){"use strict";a.d(t,{$s:function(){return d},Fs:function(){return r},Hp:function(){return u},p6:function(){return l}}),a(58110);var n=a(11838),s=a.n(n),c=a(12266),i=a(20920);let l=e=>{let t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0"),s=e.getHours().toString().padStart(2,"0"),c=e.getMinutes().toString().padStart(2,"0"),i=e.getSeconds().toString().padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n," ").concat(s,":").concat(c,":").concat(i)},r=()=>(0,i.Z)().replaceAll("-","");function d(e,t){return e[t]}let u=e=>s().sanitize(c.TU.parse(e,{async:!1,pedantic:!1,gfm:!0}))}}]);